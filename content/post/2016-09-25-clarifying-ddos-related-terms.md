+++
date = "2016-09-25T20:47:02-07:00"
description = "Spoofing, reflection, amplification, BCP38, uRPF, etc."
draft = true
slug = "clarifying-ddos-related-terms"
tags = ['DDoS', 'reflection', 'Internet', 'amplification', 'bcp38', 'urpf' ]
title = "Clarifying DDoS-related terms"

+++

I'll be writing a bit more about DDoS attacks and security, and so I thought it would be handy to jot down some commonly used terms in one place.  I'll also look at how some of those terms are interrelated.<!--more-->

#### Spoofing

As relates to TCP/IP, "spoofing" really just refers to forging some part of IP communications.  You could, for example, spoof a source port to have response data thrown at a listening application that wasn't expecting, but generally we're talking about forging the source IP address in an IP packet.  

IP spoofing can be used to simply hide your identity in attacks where replies back from the target are not necessary in order to complete the attack.

For example, TCP SYN floods cause resource exhaustion on target by making it set up many half-open TCP connections.  The attacker does not need to actually ACK replies back from the server in order to exhaust server resources, so spoofing the source IP in the SYN flood packets means (a) the attacker's true IP remains hidden from the target and (b) any replies the target generates to the attack traffic will not reach the attacker, so the attacker can expend relatively fewer resources while requiring more resources utilized on the target.

Similarly, any connectionless attack where garbage, volumetric data is thrown at a target could also use any random source IP address.  For example, a compromised host could be instructed to send random data at a target using a spoofed source IP address in order to not reveal the true IP of the compromised host, so that it can be used again in future attacks.

Spoofing can also be used in reflection attacks.

#### Reflection

A reflection attack uses spoofing in order to have the attack bounce of off a "reflector" of some sort and on to the attack target.  The attacker uses spoofing to forge the source IP address of its traffic to be that of their target.  Traffic is then sent  to the reflector, soliticing a reply.  The reply traffic, though, is sent not back to the attacker but rather on to the attack target.  This is because the reflector has no way of knowing the source of the traffic aside from the source IP address in the packets it receives, so all it can do is send replies to that IP address.

The most basic example of this would be sending an ICMP echo request (ping) to some host on the Internet and setting the source IP address to that of the attack target.  This isn't really a very efficient method on the attacker's part, though, as they have to use the same amount of resources and bandwidth as the target, if not more.  A 1500-byte echo request sent from the attacker results in a 1500-byte echo reply generated by the reflector and that 1500-byte echo reply being received by the target.  So the attacker uses 1500 bytes of upload bandwidth and has to generate that 1500 byte echo request; the reflector uses 1500 bytes of download bandwith, has to generate a 1500 byte ICMP echo reply, and then uses 1500 bytes of upload bandwidth; and the target just has to receive a 1500-byte echo reply and do some very basic processing to realize it has to discard it.

To pack a bigger punch, reflection needs to be paired with amplification.

#### Amplification

This is where things start to get interesting on the volumetric DDoS front.  We've spoofed a source IP and sent some request to a server somewhere on the Internet so that the reply gets sent to our target instead of back to us.  No how do we tip the scales to get a bigger attack?  

We need two things to pull this off:

1.   We need to be able to send a single packet to the reflector and have it reply with our attack traffic.
2.  We need hit on some type of traffic that will make the reflector generate a larger packet to send to the attacker than we sent to the reflector in the first place.

For #1, the idea here is that since we are spoofing our source address, something like TCP won't work.  TCP requires a 3-step handshake between before the connection is open and data can go between client and server.  If we hit step 1 (SYN), but step 2 from the server back to the client (SYN-ACK) doesn't come back to us but rather goes to the target, we can't complete the TCP connection setup and so we can't trigger a big bunch of data.  This is actually good design: it's BAD for a single, small request from the client to be able to trigger a BIG response from the server.  Connectionless protocols like UDP could work, though, as UDP-based protocols are more likely send the actual reply to a client request right from the word "go!".

Requirement #2 is pretty obvious, but how do we pull that off?  Well, common targets have been identified that violate the best practice suggestion of not returning more than is received on the first request/packet.  A list of some of those:

* NTP
* CHARGEN
* DNS, especially with EDNS
* SSDP
* SNMP

Now we can single a *single* packet to reflector with a spoofed source IP and have that reflector send up to almost **600 times** that amount of traffic to our target.

### How do these all go together?


