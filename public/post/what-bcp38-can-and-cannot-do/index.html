<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta content="tech, networking" name="keywords">
<meta content="Hugo" name="author">
<meta property="og:title" content="What BCP38 Can and Cannot Do - Hugo&#39;s Blog">
<meta property="og:url" content="http://blog.slabnet.com/post/what-bcp38-can-and-cannot-do/">
<meta property="og:description" content="Mostly tech...mostly">
<meta property="og:type" content="website" />
<title>What BCP38 Can and Cannot Do | Hugo&#39;s Blog</title>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<link rel="stylesheet" href="http://blog.slabnet.com//css/style.css">
<link rel="shortcut icon" href="http://blog.slabnet.com//wave.ico">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/solarized-dark.min.css">

</head>

<body>
<section class="section">
  <div class="container">
    <nav class="nav">
      <div class="nav-left">
        <a class="nav-item" href="http://blog.slabnet.com/"><h1 class="title is-4">Hugo&#39;s Blog</h1></a>
      </div>
      <div class="nav-right">
        <nav class="nav-item level is-mobile">
          
          <a class="level-item" href="https://github.com/hslabbert" target="_blank">
            <span class="icon">
              <i class="fa fa-github"></i>
            </span>
          </a>
          
          <a class="level-item" href="https://gitlab.com/hslabbert" target="_blank">
            <span class="icon">
              <i class="fa fa-gitlab"></i>
            </span>
          </a>
          
          <a class="level-item" href="https://twitter.com/hugoslabbert" target="_blank">
            <span class="icon">
              <i class="fa fa-twitter"></i>
            </span>
          </a>
          
          <a class="level-item" href="https://linkedin.com/in/hugoslabbert" target="_blank">
            <span class="icon">
              <i class="fa fa-linkedin-square"></i>
            </span>
          </a>
          
          <a class="level-item" href="/index.xml" target="_blank">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>
          </a>
          
        </nav>
      </div>
    </nav>
  </div>
</section>

<section class="section">
  <div class="container">
    <h1 class="title">What BCP38 Can and Cannot Do</h1>
    <h2 class="subtitle is-5">September 28, 2016 by Hugo</h2>
    
      <div class="tags">
    
        <a class="button is-link" href="/tags/infosec">infosec</a>
    
        <a class="button is-link" href="/tags/internet">Internet</a>
    
        <a class="button is-link" href="/tags/ddos">DDoS</a>
    
        <a class="button is-link" href="/tags/bcp38">BCP38</a>
    
        <a class="button is-link" href="/tags/reflection">reflection</a>
    
        <a class="button is-link" href="/tags/security">security</a>
    
        <a class="button is-link" href="/tags/networking">networking</a>
    
</div>

    
    <div class="content">
      

<p>We&rsquo;re coming through what is seeming like a tipping point in the history of DDoS on the Internet.  Rather than targeting a company or online gaming, one of the largest DDoS attacks ever <a href="http://krebsonsecurity.com/2016/09/krebsonsecurity-hit-with-record-ddos/">targeted an individual</a>, Brian Krebs, most likely for <a href="https://krebsonsecurity.com/2016/09/israeli-online-attack-service-vdos-earned-600000-in-two-years/">his work exposing a so-called &ldquo;booter service&rdquo;</a>, a DDoS-for-hire outfit called vDOS, which ultimately led to <a href="https://krebsonsecurity.com/2016/09/alleged-vdos-proprietors-arrested-in-israel/">the alleged proprietors being arrested</a>.</p>

<h2 id="a-brief-history-of-dos-volumes">A brief history of DoS volumes</h2>

<p>Public information about DDoS attack volumes are generally sparse outside of news releases and blog posts of DDoS mitigation companies, but even as late as last year, attacks of around 400 Gbps were exceptional events and pretty much the biggest the Internet had seen.  Attacks weighing in at 600 Gbps are said to have been reported in private, but generally haven&rsquo;t hit public knowledge. In the space of a week, we&rsquo;ve seen attacks reach those levels and <em>way</em> beyond.  There are reports of <em>much</em> more frequent attacks against common targets, with volumes far above average.  OVH, an international Internet service and hosting provider, reported attacks of over 1 Tbps just the night before the attack on KrebsOnSecurity:</p>

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">we got 2 huge multi DDoS: 1156Gbps then 901Gbps <a href="https://t.co/NyFTr6KLCC">pic.twitter.com/NyFTr6KLCC</a></p>&mdash; Octave Klaba (@olesovhcom) <a href="https://twitter.com/olesovhcom/status/778019962036314112">September 19, 2016</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>This is an unprecedented escalation in attack volumes and frequency, and this state of affairs cannot go on.  The Internet is <em>the</em> platform for discussion in our era, and it is simply unacceptable, whether you are a security researcher, a political activist, someone with an unpopular opinion, or simply someone running a blog for fun, that your voice on the Internet could be silenced by goons with digital cannons because they don&rsquo;t like what you have to say, or simply for the lulz.</p>

<p>After getting <a href="https://krebsonsecurity.com">krebsonsecurity.com</a> back online on 2016-09-24, Krebs responded to the recent events with a report and call to action in <a href="https://krebsonsecurity.com/2016/09/the-democratization-of-censorship/">The Democritizaton of Censorship</a>.  In it, he calls for a renewed effort on implementing <a href="/post/clarifying-ddos-related-terms/#bcp38">BCP38</a>:</p>

<blockquote>
<p>Known as BCP38, its use prevents insecure resources on an ISPs network (hacked servers, computers, routers, DVRs, etc.) from being leveraged in such powerful denial-of-service attacks.</p>

<p>&hellip;</p>

<p>BCP38 is designed to filter such spoofed traffic, so that it never even traverses the network of an ISP that’s adopted the anti-spoofing measures. However, there are non-trivial economic reasons that many ISPs fail to adopt this best practice. <a href="http://www.internetsociety.org/deploy360/blog/2014/07/anti-spoofing-bcp-38-and-the-tragedy-of-the-commons/">This blog post</a> from the Internet Society does a good job of explaining why many ISPs ultimately decide not to implement BCP38.</p>
</blockquote>

<p>As we face denial of service attacks, it is important for us to be clear on what tools we have in our arsenal to defend against DDoS attacks.</p>

<h2 id="no-spoofing-no-benefit-to-bcp38">No spoofing?  No benefit to BCP38</h2>

<p>I will be very clear that I am a strong proponent of BCP38.  There are objections from some members the network operator community that need to be addressed and solutions to some valid network use cases that need to be developed, but on the whole we should be working to push spoof-detection and mitigation as a default state rather than throwing our hands up in the air and saying it&rsquo;s too hard or a futile effort.</p>

<p>That said: BCP38 does <strong>NOT</strong> defend against direct network attacks that do not use source address spoofing.  Period.</p>

<p>BCP38&rsquo;s sole function is to drop traffic from invalid (spoofed) source addresses.  Now, spoofing <em>can</em> be used in direct attacks in order to provide source address obfuscation, but those attacks need to be &ldquo;one and done&rdquo; vectors, e.g. SYN flood attacks or UDP-based attacks that hinge simply on a single packet making its way from the traffic originator (the host we&rsquo;re talking about that&rsquo;s using spoofing) to the target.</p>

<p>A direct, TCP-based attack that requires a TCP 3-way handshake to complete <em>cannot</em> use source address spoofing, as the SYN-ACK back from the target will go to a spoofed address and never reach the attacker to complete the TCP session setup.  As the TCP session setup never completes, any direct attack that requires a valid TCP session will not be able to function.  If source address spoofing is not being used, BCP38 has absolutely <strong>zero</strong> impact on that traffic; it&rsquo;s not spoofed, so BCP38 let&rsquo;s it pass (as it should).</p>

<p>But, the <a href="http://krebsonsecurity.com/2016/09/krebsonsecurity-hit-with-record-ddos/">post-mortem breakdown</a> from Krebs indicates that these attacks did not use reflection &amp; amplification:</p>

<blockquote>
<p>But according to Akamai, none of the attack methods employed in Tuesday night’s assault on KrebsOnSecurity relied on amplification or reflection. Rather, many were garbage Web attack methods that require a legitimate connection between the attacking host and the target, including SYN, GET and POST floods.</p>
</blockquote>

<p>Note the &ldquo;legitimate connection&rdquo; part there, which I am reading as a valid TCP session.</p>

<p>Akamai&rsquo;s Martin McKeay also goes on to say that this traffic cannot be spoofed:</p>

<blockquote>
<p>McKeay explained that the source of GRE traffic can’t be spoofed or faked the same way DDoS attackers can spoof DNS traffic. Nor can junk Web-based DDoS attacks like those mentioned above.</p>
</blockquote>

<p>Now, I <a href="/post/gre-reflection/">took some exception</a> to the statement that GRE traffic cannot be spoofed, and to be fair you can fake a GET or POST as long as you don&rsquo;t care if the TCP session is invalid and the web server at the other end will reject it, but the point here is that the analysis of the attack describes it as consisting of direct attacks including legitimate, completed TCP sessions, <em>without</em> spoofing taking place.</p>

<p>Krebs touches on this again later in the Democritization piece when talking about the IoT devices likely participating in the attack:</p>

<blockquote>
<p>Some readers on Twitter have asked why the attackers would have “burned” so many compromised systems with such an overwhelming force against my little site. After all, they reasoned, the attackers showed their hand in this assault, exposing the Internet addresses of a huge number of compromised devices that might otherwise be used for actual money-making cybercriminal activities&hellip;</p>
</blockquote>

<p>Again: if they&rsquo;re exposing their IP addresses, that means we&rsquo;re talking about abuse traffic that does <em>not</em> have a spoofed source, which means whether or not BCP38 is implemented on the networks housing the attack sources has <strong>zero</strong> bearing on the effectiveness of the attack.</p>

<p>Krebs does later touch on the possibility of initiatives to require secure-by-default deployments for IoT devices, but that basically amounts to two sentences at the end of the <em>Shaming the Spoofers</em> section.  In light of these attacks being claimed as direct and unspoofed, efforts to secure end hosts would really be the only effective countermeasure, as source address spoofing mitigation has zero effect on traffic that doesn&rsquo;t spoof its source address.</p>

<p>I aim to write more about BCP38 in the near future, but I want to state again for emphasis that this post is <em>not</em> a criticism of BCP38 or any kind of statement that BCP38 adoption is pointless or futile.  On the contrary: I wholeheartedly support any efforts to further BCP38 adoption, push for BCP38 adoption on any networks under my control, and believe it is critical to enabling attribution of abuse traffic and mitigation of reflected (and amplified) DDoS attacks.  But, we should not imagine that even getting full BCP38 coverage of the entire Internet will in any way impact network abuse and DDoS attacks that do not use source address spoofing.</p>

    </div>
    
        <div class="nav-left">
    <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fblog.slabnet.com%2fpost%2fwhat-bcp38-can-and-cannot-do%2f" title="Share on Facebook" target="_blank"><span class="fa fa-facebook fa-2x" aria-hidden="true"></span></a>
    <a class="nav-item" href="https://plus.google.com/share?url=http%3a%2f%2fblog.slabnet.com%2fpost%2fwhat-bcp38-can-and-cannot-do%2f" title="Share on Google+" target="_blank"><span class="fa fa-google-plus fa-2x" aria-hidden="true"></span></a>
    <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2fblog.slabnet.com%2fpost%2fwhat-bcp38-can-and-cannot-do%2f" title="Share on LinkedIn" target="_blank"><span class="fa fa-linkedin fa-2x" aria-hidden="true"></span></a>
    <a class="nav-item" href="https://twitter.com/home?status=What%20BCP38%20Can%20and%20Cannot%20Do - http%3a%2f%2fblog.slabnet.com%2fpost%2fwhat-bcp38-can-and-cannot-do%2f" title="Tweet this" target="_blank"><span class="fa fa-twitter fa-2x"></span></a>
    <a class="nav-item" href="http://www.reddit.com/submit?url=http%3a%2f%2fblog.slabnet.com%2fpost%2fwhat-bcp38-can-and-cannot-do%2f&title=What%20BCP38%20Can%20and%20Cannot%20Do" title="Share on Reddit" target="_blank"><span class="fa fa-reddit-alien fa-2x" aria-hidden="true"></span></a>
    
    </div>
    
  </div>
</section>

<section class="section">
  <div class="container">
    <aside><div id="disqus_thread"></div></aside>
    <script type="text/javascript">
      var disqus_shortname = 'blog-slabnet-com';
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  </div>
</section>


<section class="section">
  <div class="container has-text-centered">
    <p>&copy; 2017 Hugo Slabbert. <a href="http://creativecommons.org/licenses/by/4.0/">Some rights reserved</a>. Please attribute properly and link back.</p>
  </div>
</section>


<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js" integrity="sha256-+bhVTaRmJ/c07eV80nU8gD2cBBF0rYkf1txqXlrbvb0=" crossorigin="anonymous"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/languages/bash.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/languages/go.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/languages/dockerfile.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/languages/python.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/languages/powershell.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script>hljs.initHighlightingOnLoad();</script>


</body>
