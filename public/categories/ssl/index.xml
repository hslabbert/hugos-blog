<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Ssl on Hugo&#39;s Blog</title>
    <link>https://bamboo.slabnet.com/~hslabbert/blog/categories/ssl/</link>
    <description>Recent content in Ssl on Hugo&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <managingEditor>hugo@slabnet.com (Hugo Slabbert)</managingEditor>
    <webMaster>hugo@slabnet.com (Hugo Slabbert)</webMaster>
    <copyright>&amp;copy; 2016 Hugo Slabbert</copyright>
    <lastBuildDate>Mon, 09 Feb 2009 16:36:55 +0000</lastBuildDate>
    <atom:link href="https://bamboo.slabnet.com/~hslabbert/blog/categories/ssl/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Workaround for mysqldump SSL error 2026 bug #27669</title>
      <link>https://bamboo.slabnet.com/~hslabbert/blog/post/workaround-for-mysqldump-ssl-error-2026-bug-27669/</link>
      <pubDate>Mon, 09 Feb 2009 16:36:55 +0000</pubDate>
      <author>hugo@slabnet.com (Hugo Slabbert)</author>
      <guid>https://bamboo.slabnet.com/~hslabbert/blog/post/workaround-for-mysqldump-ssl-error-2026-bug-27669/</guid>
      <description>&lt;p&gt;I had not previously played aroung much with MySQL replication, but got the chance to do so recently. I&amp;rsquo;m doing some testing with a new mail filter setup composed of &lt;a href=&#34;http://www.ijs.si/software/amavisd/&#34;&gt;amavisd-new&lt;/a&gt;, &lt;a href=&#34;http://spamassassin.apache.org/&#34;&gt;SpamAssassin&lt;/a&gt;, and some other SA modules running through &lt;a href=&#34;http://www.postfix.org/&#34;&gt;Postfix&lt;/a&gt; on &lt;a href=&#34;http://www.debian.org/&#34;&gt;Debian&lt;/a&gt; Etch. The setup uses &lt;a href=&#34;http://www.maiamailguard.com/&#34;&gt;Maia Mailguard&lt;/a&gt; as a web front-end and management system, including per-user settings and quarantines. We&amp;rsquo;re using MySQL for the database backend for Maia for storing quarantines, per-user settings and the like, but wanted to have a dual-MX setup with a secondary MX sitting in a remote site.&lt;/p&gt;

&lt;p&gt;&lt;!-- more --&gt;So, we needed some way to keep the MySQL data between the two servers in sync. I had looked at &lt;a href=&#34;http://www.drbd.org/&#34;&gt;DRBD&lt;/a&gt; and &lt;a href=&#34;http://www.linux-ha.org/&#34;&gt;linux-ha&lt;/a&gt;, but in the end decided to go with a dual-master &lt;a href=&#34;http://dev.mysql.com/doc/refman/5.0/en/replication.html&#34;&gt;MySQL replication&lt;/a&gt; setup (&lt;a href=&#34;http://www.neocodesoftware.com/replication/&#34;&gt;howto1&lt;/a&gt;, &lt;a href=&#34;http://lug.wsu.edu/node/545/print&#34;&gt;howto2&lt;/a&gt;), using the built-in SSL capabilities in MySQL to encrypt the replication traffic over the WAN. After a bit of tweaking, I got that going, but then noticed that I could no longer perform mysqldump commands on the databases when running the command locally. I got the following error message whenever I tried a mysqldump command:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;Got error: 2026: SSL connection error when trying to connect&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;I wasn&amp;rsquo;t specifying any SSL parameters in the mysqldump command, though, and while I did configure the replication users to require SSL in their user setup, the mysqldump user did not have an SSL requirement. I got to the official MySQL bug report for this error(#&lt;a href=&#34;http://bugs.mysql.com/bug.php?id=27669&#34;&gt;27669&lt;/a&gt;) as well as the patch link. But to be honest, that didn&amp;rsquo;t really get me anywhere. The bug report indicates that this behaviour has been corrected in MySQL release 5.0.42, and I was running release 5.0.32.&lt;/p&gt;

&lt;p&gt;I updated the mysql-client package on a test machine to 5.0.75 and tried the mysqldump again; the same error still occurred. I didn&amp;rsquo;t want to upgrade the actual mysql-server package as well, so I looked elsewhere for a fix. It occurred to me that, in order for the MySQL replication to use SSL, I had specified the SSL-related options (ssl-ca and so forth) in the [client] section of the global configuration file at /etc/mysql/my.cnf. As mysqldump starts a MySQL client connection, it would stand to reason that it uses the [client] configuration settings that it would find in the global config file, and hence would try to use SSL.&lt;/p&gt;

&lt;p&gt;I wanted to get mysqldump to &lt;em&gt;not&lt;/em&gt; use SSL connections, but still wanted my replication traffic to use SSL. Since the mysqld daemon runs under the mysql user account, I moved the ssl-related config options out of the [client] section of the global config file of /etc/mysql/my.cnf, created a new .my.cnf config file in the mysql user&amp;rsquo;s $HOME directory (/var/lib/mysql on my system), and entered just the ssl-related options in a [client] section of that .my.cnf file. I reloaded the mysqld daemon and confirmed that the slave connection to the remote server came up properly. It did; the configuration options for the mysql user includes both the global config file of /etc/mysql/my.cnf and the per-user .my.cnf file I had just created, so it is able to pick up the ssl-related options in the [client] section of the per-user settings.&lt;/p&gt;

&lt;p&gt;NOTE: The ssl-related options I am talking about here are only those configured in the [client] section. The ssl-related options in the [mysqld] section of the global config file can stay where they are. It should work to have those present in the local mysql user&amp;rsquo;s .my.cnf config file, but I did not test this.&lt;/p&gt;

&lt;p&gt;Since no ssl-related options were specified in the global [client] configuration anymore, and no per-user settings were present for the user I was using for the mysqldump command, the command connected without SSL, the SSL error 2026 messages went away, and I was again able to successfully perform MySQL backups from the local machine.&lt;/p&gt;

&lt;p&gt;Bitcoin tip address for this post: 15ZhSjpB8iDRHvzgXphpJ9AhkJUPJw5uE5&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>